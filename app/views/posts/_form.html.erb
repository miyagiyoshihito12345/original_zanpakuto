<p class="text-danger">*必須項目</p>
<%= form_with model: post, local: true do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  <div class="form-group mt-4">
    <%= f.label :kaigo %>
    <%= f.text_field :kaigo, class: 'form-control mt-1' %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :kaigo_hurigana %>
    <%= f.text_field :kaigo_hurigana, class: 'form-control mt-1' %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :shikai %><span class="text-danger">*</span>
    <%= f.text_field :shikai, class: 'form-control mt-1' %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :shikai_hurigana %>
    <%= f.text_field :shikai_hurigana, class: 'form-control mt-1' %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :ability %><span class="text-danger">*</span>
    <%= f.text_area :ability, class: 'form-control mt-1', rows: 10 %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :bankai %>
    <%= f.text_field :bankai, class: 'form-control mt-1' %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :bankai_hurigana %>
    <%= f.text_field :bankai_hurigana, class: 'mt-1 form-control' %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :bankai_ability %>
    <%= f.text_area :bankai_ability, class: 'mt-1 form-control', rows: 10 %>
  </div>
  <script>
    function previewImage() {
      const target = this.event.target;
      const file = target.files[0];
      const reader  = new FileReader();
      reader.onloadend = function () {
        const preview = document.querySelector("#preview")
        if(preview) {
          preview.src = reader.result;
        }
      }
      if (file) {
        reader.readAsDataURL(file);
      }
    }
  </script>
  <div class="form-group mt-4">
    <%= f.label :image %>
    <%= f.file_field :image, class: 'mt-1 form-control mb-3', accept: 'image/*', onchange: 'previewImage(preview)' %>
    <%= f.hidden_field :image_cache %>
  </div>
  <div class="mt-3 mb-3">
    <%= image_tag post.image.url, id: 'preview', size: '171x153' %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :detail %>
    <%= f.text_area :detail, class: 'form-control mt-1', rows: 10 %>
  </div>
  <div class="form-group mt-4">
    <%= f.label :tag_list %>
      <%= f.text_field :tag_list, value: post.tag_list.join(','), class: "form-control mt-1", placeholder: "氷雪系,オサレ系,相手の神経操る系" %>
  </div>
  <div style="display: flex; justify-content: space-around; margin-top: 50px;">
    <% if 'new' == action_name || post.is_draft == true || 'create' == action_name %>
      <%= f.submit t('defaults.draft'), class: 'btn btn-dark' %>
    <% end %>
    <% if 'edit' == action_name && post.is_draft == false %>
      <%= f.submit t('defaults.update'), class: 'btn btn-dark' %>
    <% else %>
      <%= f.submit t('defaults.post'), class: 'btn btn-dark' %>
    <% end %>
  </div>
<% end %>
